// This is your Prisma schema file,
// learn more about it in the docs https//pris.ly/d/prisma-schema

// Looking for ways to speed up your queries, or scale easily with your serverless or edge functions?
// Try Prisma Accelerate https//pris.ly/cli/accelerate-init

// datasource db {
//   provider = "postgresql"
//   url      = env("DATABASE_URL")
// }

datasource db {
  provider  = "postgresql"
  url       = env("DATABASE_URL")
  directUrl = env("DIRECT_URL")
}

generator client {
  provider        = "prisma-client-js"
  previewFeatures = ["multiSchema"]
}

enum Beds {
  double
  single
  crib
}

enum Amenities {
  Wifi
  Heating
  AirConditioning
  Washer
  Dryer
  Iron
  Essentials
  HotWater
  TV
  Refrigerator
  Microwave
  CoffeeMaker
  CookingBasics
  Oven
  Stove
  Dishwasher
  DishesAndSilverware
  Kitchen
  SmokeAlarm
  CarbonMonoxideAlarm
  FirstAidKit
  FireExtinguisher
  BedroomLock
  HighChair
  BabySafetyGates
  BabysitterRecommendations
  FreeParkingOnPremises
  PaidParkingOffPremises
  PaidParkingOnPremises
  Elevator
  WheelchairAccessible
  BbqGrill
  PatioOrBalcony
  GardenOrBackyard
  PrivateEntrance
  Gym
  Pool
  HotTub
  Sauna
  LongTermStaysAllowed
  LuggageDropoffAllowed
  CleaningBeforeCheckout
  PetsAllowed
  BoardGames
  BooksAndReadingMaterial
  SmartTV
  DedicatedWorkspace
}

enum AmenitiesType {
  Basic
  Kitchen
  Safety
  Family
  Parking_and_Accessibility
  Outdoor
  Fitness
  Additional
  Pets
  Entertainment
}

model Stay {
  id          String    @id @default(uuid())
  name        String
  type        String
  price       Float
  summary     String
  description String?
  capacity    Int
  baths       Int?
  uniqueRooms String[]
  hostId      String
  host        Profile   @relation(fields: [hostId], references: [id], onDelete: Cascade)
  locationId  String    @unique
  location    Location  @relation(fields: [locationId], references: [id], onDelete: Cascade)
  images      Image[]
  amenities   Amenity[] @relation("StayAmenities")
  labels      Label[]
  reviews     Review[]
  likes       Like[]
  bedrooms    BedRoom[]
  booking     Booking[]
}

model Review {
  id     String  @id @default(uuid())
  stayId String
  stay   Stay    @relation(fields: [stayId], references: [id] )
  text   String
  rate   Int
  userId String
  user   Profile @relation(fields: [userId], references: [id])
}

model Profile {
  id         String    @id @default(uuid())
  supabaseId String    @unique
  isOwner    Boolean
  ownerSince DateTime?
  firstName  String
  lastName   String
  imgUrl     String
  dob        DateTime
  stays      Stay[]
  review     Review[]
  likes      Like[]
  bookings   Booking[] @relation("booker")
  hosting    Booking[] @relation("host")

  @@map("User")
}

model Location {
  id          String @id @default(uuid())
  country     String
  countryCode String
  city        String
  address     String
  lat         Float
  lng         Float
  stay        Stay?
}

model Amenity {
  id    String    @id @default(uuid())
  name  Amenities
  stays Stay[]    @relation("StayAmenities")
}

model BedRoom {
  id     String  @id @default(uuid())
  beds   Beds[]
  images Image[]
  stayId String
  stay   Stay    @relation(fields: [stayId], references: [id], onDelete: Cascade)
}

model Label {
  id    String @id @default(uuid())
  name  String
  stays Stay[]
}

model Like {
  id     String  @id @default(uuid())
  userId String
  user   Profile @relation(fields: [userId], references: [id], onDelete: Cascade)
  stayId String
  stay   Stay    @relation(fields: [stayId], references: [id], onDelete: Cascade)
}

model Image {
  id     String   @id @default(uuid())
  url    String
  stayId String?
  stay   Stay?    @relation(fields: [stayId], references: [id], onDelete: Cascade)
  Room   BedRoom? @relation(fields: [roomId], references: [id], onDelete: Cascade)
  roomId String?
}

model Booking {
  id          String   @id @default(uuid())
  stayId      String?
  stay        Stay?    @relation(fields: [stayId], references: [id])
  userId      String
  user        Profile  @relation("booker", fields: [userId], references: [id])
  hostId      String
  host        Profile  @relation("host", fields: [hostId], references: [id])
  price       Float
  adults      Int
  children    Int?
  infants     Int?
  pets        Int?
  checkIn     DateTime
  checkOut    DateTime
  bookingTime DateTime
}
